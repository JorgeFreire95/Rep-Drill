# Generated by Django 4.2.7 on 2025-10-23 18:50

from decimal import Decimal
import django.core.validators
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='StockReorderRecommendation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('product_id', models.IntegerField(db_index=True)),
                ('product_name', models.CharField(max_length=200)),
                ('product_sku', models.CharField(blank=True, max_length=100, null=True)),
                ('warehouse_id', models.IntegerField(blank=True, db_index=True, null=True)),
                ('warehouse_name', models.CharField(blank=True, max_length=200, null=True)),
                ('current_stock', models.IntegerField(default=0)),
                ('min_stock_level', models.IntegerField(default=0)),
                ('average_daily_demand', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10)),
                ('predicted_demand_7days', models.IntegerField(default=0, help_text='Demanda predicha para los próximos 7 días')),
                ('predicted_demand_30days', models.IntegerField(default=0, help_text='Demanda predicha para los próximos 30 días')),
                ('recommended_order_quantity', models.IntegerField(default=0, help_text='Cantidad recomendada a ordenar')),
                ('reorder_priority', models.CharField(choices=[('urgent', 'Urgente'), ('high', 'Alta'), ('medium', 'Media'), ('low', 'Baja')], default='medium', max_length=20)),
                ('safety_stock', models.IntegerField(default=0, help_text='Stock de seguridad recomendado')),
                ('reorder_point', models.IntegerField(default=0, help_text='Punto de reorden (cuando ordenar)')),
                ('stockout_date_estimate', models.DateField(blank=True, help_text='Fecha estimada de agotamiento', null=True)),
                ('recommended_order_date', models.DateField(blank=True, help_text='Fecha recomendada para hacer el pedido', null=True)),
                ('status', models.CharField(choices=[('pending', 'Pendiente'), ('reviewed', 'Revisada'), ('ordered', 'Ordenada'), ('dismissed', 'Descartada')], default='pending', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Recomendación de Reorden',
                'verbose_name_plural': 'Recomendaciones de Reorden',
                'db_table': 'analytics_stock_reorder_recommendation',
                'ordering': ['-reorder_priority', 'stockout_date_estimate'],
                'indexes': [models.Index(fields=['product_id', 'warehouse_id'], name='analytics_s_product_8cd6be_idx'), models.Index(fields=['reorder_priority', '-created_at'], name='analytics_s_reorder_b7cc0d_idx'), models.Index(fields=['status'], name='analytics_s_status_298b42_idx'), models.Index(fields=['stockout_date_estimate'], name='analytics_s_stockou_62f7d2_idx')],
            },
        ),
        migrations.CreateModel(
            name='ProductDemandMetrics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('product_id', models.IntegerField(db_index=True)),
                ('product_name', models.CharField(max_length=200)),
                ('product_sku', models.CharField(blank=True, max_length=100, null=True)),
                ('period_start', models.DateField()),
                ('period_end', models.DateField()),
                ('period_days', models.IntegerField(default=30)),
                ('total_quantity_sold', models.IntegerField(default=0, help_text='Cantidad total vendida en el período')),
                ('total_orders', models.IntegerField(default=0, help_text='Número de órdenes que incluyeron este producto')),
                ('average_daily_demand', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Promedio de unidades vendidas por día', max_digits=10)),
                ('max_daily_demand', models.IntegerField(default=0, help_text='Máximo de unidades vendidas en un día')),
                ('min_daily_demand', models.IntegerField(default=0, help_text='Mínimo de unidades vendidas en un día')),
                ('total_revenue', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Ingresos totales del producto', max_digits=12)),
                ('average_price', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Precio promedio de venta', max_digits=10)),
                ('trend', models.CharField(choices=[('increasing', 'Aumentando'), ('stable', 'Estable'), ('decreasing', 'Disminuyendo')], default='stable', max_length=20)),
                ('trend_percentage', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Cambio porcentual en la demanda (+ o -)', max_digits=6)),
                ('calculated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Métrica de Demanda de Producto',
                'verbose_name_plural': 'Métricas de Demanda de Productos',
                'db_table': 'analytics_product_demand_metrics',
                'ordering': ['-average_daily_demand'],
                'indexes': [models.Index(fields=['product_id', '-period_end'], name='analytics_p_product_675e82_idx'), models.Index(fields=['-average_daily_demand'], name='analytics_p_average_c45934_idx'), models.Index(fields=['trend'], name='analytics_p_trend_cbf52b_idx')],
                'unique_together': {('product_id', 'period_start', 'period_end')},
            },
        ),
        migrations.CreateModel(
            name='InventoryTurnoverMetrics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('product_id', models.IntegerField(db_index=True)),
                ('product_name', models.CharField(max_length=200)),
                ('warehouse_id', models.IntegerField(blank=True, db_index=True, null=True)),
                ('warehouse_name', models.CharField(blank=True, max_length=200, null=True)),
                ('period_start', models.DateField()),
                ('period_end', models.DateField()),
                ('period_days', models.IntegerField(default=30)),
                ('average_inventory', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Inventario promedio en el período', max_digits=10)),
                ('starting_inventory', models.IntegerField(default=0, help_text='Inventario al inicio del período')),
                ('ending_inventory', models.IntegerField(default=0, help_text='Inventario al final del período')),
                ('units_sold', models.IntegerField(default=0, help_text='Unidades vendidas en el período')),
                ('cost_of_goods_sold', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Costo de los productos vendidos', max_digits=12)),
                ('turnover_rate', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Tasa de rotación (veces que se vendió el inventario)', max_digits=6, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))])),
                ('days_of_inventory', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Días de inventario disponible', max_digits=6, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))])),
                ('classification', models.CharField(choices=[('fast_moving', 'Rápida Rotación'), ('medium_moving', 'Rotación Media'), ('slow_moving', 'Rotación Lenta'), ('obsolete', 'Obsoleto')], default='medium_moving', max_length=20)),
                ('stockout_risk', models.CharField(choices=[('high', 'Alto'), ('medium', 'Medio'), ('low', 'Bajo')], default='low', help_text='Riesgo de quedarse sin stock', max_length=20)),
                ('overstock_risk', models.CharField(choices=[('high', 'Alto'), ('medium', 'Medio'), ('low', 'Bajo')], default='low', help_text='Riesgo de exceso de inventario', max_length=20)),
                ('calculated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Métrica de Rotación de Inventario',
                'verbose_name_plural': 'Métricas de Rotación de Inventario',
                'db_table': 'analytics_inventory_turnover_metrics',
                'ordering': ['-turnover_rate'],
                'indexes': [models.Index(fields=['product_id', 'warehouse_id', '-period_end'], name='analytics_i_product_2daf0e_idx'), models.Index(fields=['-turnover_rate'], name='analytics_i_turnove_0f64a5_idx'), models.Index(fields=['classification'], name='analytics_i_classif_1c6f2d_idx'), models.Index(fields=['stockout_risk'], name='analytics_i_stockou_66ce8c_idx')],
                'unique_together': {('product_id', 'warehouse_id', 'period_start', 'period_end')},
            },
        ),
        migrations.CreateModel(
            name='DailySalesMetrics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date', models.DateField(db_index=True)),
                ('total_sales', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Total de ventas del día', max_digits=12)),
                ('total_orders', models.IntegerField(default=0, help_text='Número total de órdenes completadas')),
                ('average_order_value', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Valor promedio de cada orden', max_digits=12)),
                ('products_sold', models.IntegerField(default=0, help_text='Cantidad total de productos vendidos')),
                ('unique_products', models.IntegerField(default=0, help_text='Número de productos únicos vendidos')),
                ('unique_customers', models.IntegerField(default=0, help_text='Número de clientes únicos que compraron')),
                ('calculated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Métrica Diaria de Ventas',
                'verbose_name_plural': 'Métricas Diarias de Ventas',
                'db_table': 'analytics_daily_sales_metrics',
                'ordering': ['-date'],
                'indexes': [models.Index(fields=['-date'], name='analytics_d_date_d1173f_idx'), models.Index(fields=['calculated_at'], name='analytics_d_calcula_d4d108_idx')],
                'unique_together': {('date',)},
            },
        ),
        migrations.CreateModel(
            name='CategoryPerformanceMetrics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('category_id', models.IntegerField(db_index=True)),
                ('category_name', models.CharField(max_length=200)),
                ('period_start', models.DateField()),
                ('period_end', models.DateField()),
                ('period_days', models.IntegerField(default=30)),
                ('total_revenue', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12)),
                ('total_units_sold', models.IntegerField(default=0)),
                ('total_orders', models.IntegerField(default=0)),
                ('average_order_value', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12)),
                ('total_products', models.IntegerField(default=0, help_text='Total de productos en la categoría')),
                ('active_products', models.IntegerField(default=0, help_text='Productos que tuvieron ventas')),
                ('revenue_share', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Porcentaje del revenue total', max_digits=5)),
                ('growth_rate', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Tasa de crecimiento vs período anterior', max_digits=6)),
                ('calculated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Métrica de Rendimiento de Categoría',
                'verbose_name_plural': 'Métricas de Rendimiento de Categorías',
                'db_table': 'analytics_category_performance_metrics',
                'ordering': ['-total_revenue'],
                'indexes': [models.Index(fields=['category_id', '-period_end'], name='analytics_c_categor_b776f4_idx'), models.Index(fields=['-total_revenue'], name='analytics_c_total_r_71675f_idx')],
                'unique_together': {('category_id', 'period_start', 'period_end')},
            },
        ),
    ]
